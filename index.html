<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aprende Python Interactivo</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;600&family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

    <!-- Configuraci贸n personalizada de Tailwind -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['Fira Code', 'monospace'],
                    },
                    colors: {
                        brand: {
                            dark: '#0f172a',    // Slate 900
                            primary: '#3b82f6', // Blue 500
                            accent: '#8b5cf6',  // Violet 500
                            success: '#10b981', // Emerald 500
                            editor: '#1e293b',  // Slate 800
                        }
                    }
                }
            }
        }
    </script>

    <style>
        /* Estilos base y utilidades personalizadas */
        body {
            background-color: #f8fafc; /* Slate 50 */
        }

        /* Animaci贸n suave para transiciones */
        .transition-all-300 {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Editor de C贸digo: Scrollbar personalizado oscuro */
        .custom-scrollbar::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: #1e293b;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #475569;
            border-radius: 5px;
            border: 2px solid #1e293b;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }

        /* Scrollbar general m谩s sutil */
        .page-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        .page-scrollbar::-webkit-scrollbar-thumb {
            background-color: #cbd5e1;
            border-radius: 4px;
        }

        /* Efecto de "Active" en navegaci贸n con borde degradado */
        .nav-item.active {
            background: linear-gradient(90deg, rgba(59, 130, 246, 0.1) 0%, transparent 100%);
            border-left: 4px solid #3b82f6;
            color: #3b82f6;
        }
        
        /* Efecto Glow sutil para tarjetas */
        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        .card-shadow:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transform: translateY(-2px);
        }

        /* Terminal blinking cursor animation */
        .cursor-blink {
            animation: blink 1s step-end infinite;
        }
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
    </style>
</head>
<body class="h-screen flex flex-col md:flex-row overflow-hidden text-slate-800">

    <!-- 
      =======================================================================
      SIDEBAR (Navegaci贸n)
      Dise帽o oscuro con degradado
      =======================================================================
    -->
    <aside class="w-full md:w-72 bg-slate-900 text-slate-300 flex-shrink-0 flex flex-col z-30 shadow-2xl h-auto md:h-full relative">
        <!-- Logo Area -->
        <div class="p-6 border-b border-slate-800 flex items-center gap-3 bg-slate-950">
            <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-blue-500 to-violet-600 flex items-center justify-center shadow-lg text-white">
                <i class="fa-brands fa-python text-2xl"></i>
            </div>
            <div>
                <h1 class="text-xl font-bold text-white tracking-tight">CallOf-<span class="text-blue-500">PY</span></h1>
                <p class="text-xs text-slate-500 font-medium">Aprende c贸digo real</p>
            </div>
            <!-- Bot贸n men煤 m贸vil -->
            <button id="mobile-menu-btn" class="md:hidden ml-auto text-slate-400 hover:text-white transition-colors">
                <i class="fa-solid fa-bars text-xl"></i>
            </button>
        </div>

        <!-- Lista de Temas -->
        <nav id="topic-list" class="flex-1 overflow-y-auto page-scrollbar py-4 space-y-1 hidden md:block">
            <!-- Los temas se inyectan aqu铆 -->
        </nav>

        <!-- Footer Sidebar -->
        <div class="p-4 border-t border-slate-800 bg-slate-950 text-center">
            <div class="flex justify-center space-x-4 mb-2">
                <a href="#" class="text-slate-500 hover:text-blue-400 transition-colors"><i class="fa-brands fa-github"></i></a>
                <a href="#" class="text-slate-500 hover:text-blue-400 transition-colors"><i class="fa-brands fa-twitter"></i></a>
                <a href="#" class="text-slate-500 hover:text-blue-400 transition-colors"><i class="fa-solid fa-globe"></i></a>
            </div>
            <p class="text-xs text-slate-600">&copy; 2023 Callof-py Education</p>
        </div>
    </aside>

    <!-- 
      =======================================================================
      REA PRINCIPAL
      Fondo claro con patr贸n sutil
      =======================================================================
    -->
    <main class="flex-1 flex flex-col h-full overflow-hidden relative bg-slate-50">
        
        <!-- Header Superior -->
        <header class="bg-white border-b border-slate-200 px-6 py-4 shadow-sm flex justify-between items-center z-20">
            <div>
                <h2 id="lesson-title" class="text-xl font-bold text-slate-800 flex items-center gap-2">
                    <span class="inline-block w-2 h-8 bg-blue-500 rounded-full mr-1"></span>
                    Cargando lecci贸n...
                </h2>
            </div>
            
            <!-- Barra de Progreso Visual -->
            <div class="hidden sm:flex items-center gap-4">
                <div class="text-right">
                    <p class="text-xs font-bold text-slate-400 uppercase tracking-wider">Progreso</p>
                    <p id="lesson-progress-text" class="text-sm font-bold text-blue-600">0%</p>
                </div>
                <div class="w-32 h-2 bg-slate-200 rounded-full overflow-hidden">
                    <div id="progress-bar" class="h-full bg-gradient-to-r from-blue-500 to-violet-500 w-0 transition-all duration-500 ease-out"></div>
                </div>
            </div>
        </header>

        <!-- Contenedor Scrollable -->
        <div class="flex-1 overflow-y-auto page-scrollbar p-4 md:p-8 relative">
            
            <!-- Fondo decorativo desenfocado -->
            <div class="absolute top-0 left-0 w-full h-64 bg-gradient-to-b from-blue-50 to-transparent pointer-events-none z-0"></div>

            <div class="max-w-5xl mx-auto space-y-8 relative z-10">

                <!-- PANEL 1: Teor铆a -->
                <section class="bg-white rounded-xl card-shadow border border-slate-200 overflow-hidden">
                    <div class="px-6 py-4 border-b border-slate-100 bg-slate-50 flex items-center gap-2">
                        <div class="w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center">
                            <i class="fa-solid fa-graduation-cap text-sm"></i>
                        </div>
                        <h3 class="font-bold text-slate-700">Concepto Clave</h3>
                    </div>
                    <div id="theory-content" class="p-6 prose prose-slate max-w-none text-slate-600 leading-relaxed">
                        <!-- Contenido inyectado -->
                    </div>
                </section>

                <!-- PANEL 2: Pr谩ctica (Workspace) -->
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    
                    <!-- Columna Izquierda: Instrucciones -->
                    <div class="space-y-6">
                        <section class="bg-white rounded-xl card-shadow border border-slate-200 p-6 h-full flex flex-col">
                            <div class="flex items-center gap-2 mb-4">
                                <div class="w-8 h-8 rounded-full bg-amber-100 text-amber-600 flex items-center justify-center">
                                    <i class="fa-solid fa-lightbulb"></i>
                                </div>
                                <h3 class="font-bold text-slate-700">Tu Misi贸n</h3>
                            </div>
                            
                            <div id="challenge-desc" class="flex-1 text-slate-700 font-medium mb-6">
                                <!-- Descripci贸n inyectada -->
                            </div>

                            <!-- Consola de Resultados (Estilo Terminal) -->
                            <div class="mt-auto">
                                <div class="flex items-center justify-between mb-2">
                                    <label class="text-xs font-bold text-slate-400 uppercase tracking-wider flex items-center gap-1">
                                        <i class="fa-solid fa-terminal"></i> Terminal Output
                                    </label>
                                    <span id="status-badge" class="px-2 py-0.5 rounded text-[10px] font-bold bg-slate-200 text-slate-500 uppercase">Idle</span>
                                </div>
                                <div id="console-output" class="bg-slate-900 rounded-lg p-4 font-mono text-sm min-h-[120px] max-h-[200px] overflow-y-auto custom-scrollbar text-slate-300 border border-slate-800 shadow-inner">
                                    <span class="text-slate-500">$ python3 main.py</span><br>
                                    <span class="opacity-50">Esperando ejecuci贸n...</span><span class="cursor-blink text-blue-500">_</span>
                                </div>
                            </div>
                        </section>
                    </div>

                    <!-- Columna Derecha: Editor de C贸digo -->
                    <div class="flex flex-col h-full">
                        <!-- Ventana del Editor (Estilo macOS) -->
                        <div class="rounded-t-xl bg-slate-800 px-4 py-3 flex items-center justify-between border-b border-slate-700 shadow-lg">
                            <div class="flex gap-2">
                                <div class="w-3 h-3 rounded-full bg-red-500 hover:bg-red-600 transition-colors"></div>
                                <div class="w-3 h-3 rounded-full bg-yellow-500 hover:bg-yellow-600 transition-colors"></div>
                                <div class="w-3 h-3 rounded-full bg-green-500 hover:bg-green-600 transition-colors"></div>
                            </div>
                            <div class="text-xs font-mono text-slate-400 flex items-center gap-2">
                                <i class="fa-brands fa-python"></i> main.py
                            </div>
                            <div class="text-xs text-slate-500">Python 3.11</div>
                        </div>

                        <!-- rea de Texto del Editor -->
                        <div class="flex-1 relative bg-slate-900 border-x border-slate-800 shadow-2xl editor-container group">
                            <!-- N煤meros de l铆nea simulados -->
                            <div class="absolute left-0 top-0 bottom-0 w-10 bg-slate-900 border-r border-slate-800 text-slate-600 text-right pr-2 pt-4 font-mono text-sm select-none leading-[1.5]">
                                1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10
                            </div>
                            
                            <textarea id="code-input" 
                                class="w-full h-[300px] lg:h-full bg-transparent text-slate-200 border-none p-4 pl-12 font-mono text-sm leading-[1.5] resize-none focus:outline-none custom-scrollbar selection:bg-blue-500/30" 
                                spellcheck="false" 
                                placeholder="# Escribe tu c贸digo Python aqu铆..."></textarea>
                        </div>

                        <!-- Barra de Herramientas del Editor -->
                        <div class="bg-slate-800 rounded-b-xl p-3 flex justify-between items-center shadow-lg border-t border-slate-700">
                            <span class="text-xs text-slate-400 hidden sm:inline"><i class="fa-solid fa-code-branch"></i> master</span>
                            
                            <div class="flex gap-3 w-full sm:w-auto">
                                <button id="run-btn" class="flex-1 sm:flex-none px-5 py-2 bg-gradient-to-r from-emerald-600 to-emerald-500 hover:from-emerald-500 hover:to-emerald-400 text-white text-sm font-semibold rounded-lg shadow-lg shadow-emerald-900/20 transition-all-300 flex items-center justify-center gap-2 transform active:scale-95">
                                    <i class="fa-solid fa-play text-xs"></i> Ejecutar
                                </button>
                                
                                <button id="next-btn" class="hidden flex-1 sm:flex-none px-5 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-500 hover:to-indigo-500 text-white text-sm font-semibold rounded-lg shadow-lg shadow-blue-900/20 transition-all-300 items-center justify-center gap-2 transform active:scale-95 animate-pulse">
                                    Siguiente <i class="fa-solid fa-arrow-right text-xs"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                </div> <!-- Fin Grid -->
                
                <div class="h-8"></div> <!-- Espaciador final -->
            </div>
        </div>
    </main>

    <!-- 
      =======================================================================
      JAVASCRIPT LGICA (Funcionalidad preservada y mejorada)
      =======================================================================
    -->
    <script>
        /* --- DATOS: Configuraci贸n de las Lecciones --- */
        const lessons = [
            {
                id: 0,
                title: "Variables y Asignaci贸n",
                theory: `
                    <p class="mb-4">Imagina que una variable es como una <strong>etiqueta</strong> que le pones a una caja para saber qu茅 hay dentro. En Python, crear una variable es tan f谩cil como elegir un nombre y usar el operador <code>=</code>.</p>
                    <div class="bg-slate-100 p-4 rounded-lg border-l-4 border-blue-500 mb-4 font-mono text-sm text-slate-700 shadow-sm">
                        <span class="text-blue-600">nombre_variable</span> <span class="text-slate-400">=</span> <span class="text-green-600">valor</span>
                    </div>
                    <p>No necesitas decirle a Python qu茅 tipo de dato es; 茅l lo averigua por ti (tipado din谩mico).</p>
                `,
                challenge: "Necesitamos guardar la edad de un usuario. Crea una variable llamada <code class='text-red-500 bg-red-50 px-1 rounded border border-red-100'>edad</code> y as铆gnale el valor <code class='text-blue-600 bg-blue-50 px-1 rounded border border-blue-100'>25</code>.",
                initialCode: "# Tu c贸digo va aqu铆\n\n",
                validate: (code) => {
                    const regex = /(^|\n)\s*edad\s*=\s*25\s*($|\n|#)/;
                    if (regex.test(code)) {
                        return { success: true, output: "Variable creada en memoria: { edad: 25 }", message: "隆Excelente! Has definido tu primera variable." };
                    } else {
                        if(code.includes('25') && !code.includes('edad')) return { success: false, output: "Error: Valor 25 encontrado, pero falta la variable 'edad'.", message: "Revisa el nombre de la variable." };
                        if(code.includes('edad') && !code.includes('25')) return { success: false, output: "Error: Variable 'edad' encontrada, valor incorrecto.", message: "La variable debe valer 25." };
                        return { success: false, output: "NameError: name 'edad' is not defined", message: "Intenta escribir: edad = 25" };
                    }
                }
            },
            {
                id: 1,
                title: "Strings y Concatenaci贸n",
                theory: `
                    <p class="mb-4">Las cadenas de texto (<strong>Strings</strong>) son secuencias de caracteres encerradas en comillas. Puedes usar comillas simples <code>' '</code> o dobles <code>" "</code>.</p>
                    <p class="mb-2">驴Quieres unir dos textos? 隆S煤malos!</p>
                    <div class="bg-slate-100 p-4 rounded-lg border-l-4 border-violet-500 mb-4 font-mono text-sm text-slate-700 shadow-sm">
                        print(<span class="text-green-600">"Hola "</span> + <span class="text-green-600">"Mundo"</span>)
                    </div>
                `,
                challenge: "Usa <code>print()</code> para mostrar en la consola el saludo: <strong>Hola Python</strong>. Aseg煤rate de escribirlo exactamente igual.",
                initialCode: "# Imprime el saludo abajo\n",
                validate: (code) => {
                    const regex = /print\s*\(\s*(["'])Hola Python\1\s*\)/;
                    if (regex.test(code)) {
                        return { success: true, output: "Hola Python", message: "隆Perfecto! Dominas la impresi贸n en pantalla." };
                    }
                    return { success: false, output: "Error de salida", message: "Aseg煤rate de usar print() con el texto 'Hola Python' entre comillas." };
                }
            },
            {
                id: 2,
                title: "L贸gica Condicional (If)",
                theory: `
                    <p class="mb-4">Los programas necesitan tomar decisiones. La sentencia <code>if</code> (si) eval煤a si algo es verdadero.</p>
                    <div class="bg-amber-50 p-4 rounded-lg border border-amber-200 mb-4 text-sm text-amber-800 flex gap-3 items-start">
                        <i class="fa-solid fa-triangle-exclamation mt-1"></i>
                        <div><strong>隆Cuidado con la indentaci贸n!</strong><br>En Python, los espacios al inicio de la l铆nea son obligatorios para indicar qu茅 c贸digo va dentro del if.</div>
                    </div>
                    <div class="bg-slate-100 p-4 rounded-lg border-l-4 border-pink-500 font-mono text-sm text-slate-700 shadow-sm">
                        <span class="text-purple-600">if</span> numero > <span class="text-blue-600">10</span>:<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;<span class="text-blue-600">print</span>(<span class="text-green-600">"Es grande"</span>)
                    </div>
                `,
                challenge: "Escribe un <code>if</code> que verifique si <code>x</code> es mayor que 5. Si es cierto, imprime 'Mayor'. (x ya vale 10).",
                initialCode: "x = 10\n# Escribe tu if abajo:\n",
                validate: (code) => {
                    const ifRegex = /if\s+x\s*>\s*5\s*:/;
                    const printRegex = /\n\s+print\s*\(\s*(["'])Mayor\1\s*\)/;
                    
                    if (!ifRegex.test(code)) return { success: false, output: "SyntaxError: invalid syntax", message: "Revisa la l铆nea del if. 驴Olvidaste los dos puntos ':'?" };
                    if (!printRegex.test(code)) return { success: false, output: "IndentationError: expected an indented block", message: "El print debe tener 4 espacios antes." };
                    
                    return { success: true, output: "Mayor", message: "隆L贸gica impecable!" };
                }
            }
        ];

        /* --- UI Controller --- */
        let currentIndex = 0;
        
        const ui = {
            nav: document.getElementById('topic-list'),
            title: document.getElementById('lesson-title'),
            progressBar: document.getElementById('progress-bar'),
            progressText: document.getElementById('lesson-progress-text'),
            theory: document.getElementById('theory-content'),
            desc: document.getElementById('challenge-desc'),
            editor: document.getElementById('code-input'),
            console: document.getElementById('console-output'),
            statusBadge: document.getElementById('status-badge'),
            btnRun: document.getElementById('run-btn'),
            btnNext: document.getElementById('next-btn'),
            menuBtn: document.getElementById('mobile-menu-btn')
        };

        function renderNav() {
            ui.nav.innerHTML = '';
            lessons.forEach((l, idx) => {
                const btn = document.createElement('button');
                btn.onclick = () => loadLesson(idx);
                const isActive = idx === currentIndex;
                
                // Estilos din谩micos para los botones de navegaci贸n
                btn.className = `w-full text-left px-6 py-4 text-sm font-medium transition-all duration-200 border-l-4 focus:outline-none flex items-center justify-between group ${
                    isActive 
                    ? 'nav-item active' 
                    : 'border-transparent text-slate-400 hover:bg-slate-800 hover:text-slate-200'
                }`;
                
                btn.innerHTML = `
                    <span class="flex items-center gap-3">
                        <span class="w-6 h-6 rounded-md flex items-center justify-center text-xs ${isActive ? 'bg-blue-500 text-white shadow-lg shadow-blue-500/30' : 'bg-slate-800 text-slate-500 group-hover:bg-slate-700'}">${idx + 1}</span>
                        ${l.title}
                    </span>
                    ${idx < currentIndex ? '<i class="fa-solid fa-check text-emerald-500"></i>' : ''}
                `;
                ui.nav.appendChild(btn);
            });
        }

        function loadLesson(idx) {
            currentIndex = idx;
            const lesson = lessons[idx];
            
            // Animaci贸n de carga
            ui.title.innerHTML = `<span class="inline-block w-2 h-8 bg-blue-500 rounded-full mr-1"></span> ${lesson.title}`;
            ui.theory.innerHTML = lesson.theory;
            ui.desc.innerHTML = lesson.challenge;
            ui.editor.value = lesson.initialCode;
            
            // Reset Console & Controls
            ui.console.innerHTML = `<span class="text-slate-500">$ python3 main.py</span><br><span class="opacity-50">Esperando ejecuci贸n...</span><span class="cursor-blink text-blue-500">_</span>`;
            ui.console.className = "bg-slate-900 rounded-lg p-4 font-mono text-sm min-h-[120px] max-h-[200px] overflow-y-auto custom-scrollbar text-slate-300 border border-slate-800 shadow-inner";
            ui.statusBadge.className = "px-2 py-0.5 rounded text-[10px] font-bold bg-slate-200 text-slate-500 uppercase";
            ui.statusBadge.innerText = "IDLE";
            
            ui.btnNext.classList.add('hidden');
            ui.btnNext.classList.remove('flex');
            ui.btnRun.innerHTML = '<i class="fa-solid fa-play text-xs"></i> Ejecutar';
            ui.btnRun.className = "flex-1 sm:flex-none px-5 py-2 bg-gradient-to-r from-emerald-600 to-emerald-500 hover:from-emerald-500 hover:to-emerald-400 text-white text-sm font-semibold rounded-lg shadow-lg shadow-emerald-900/20 transition-all-300 flex items-center justify-center gap-2 transform active:scale-95";

            // Update Progress
            const progress = Math.round(((idx) / lessons.length) * 100);
            ui.progressBar.style.width = `${progress}%`;
            ui.progressText.innerText = `${progress}%`;

            renderNav();
            
            // Mobile Menu Close
            if(window.innerWidth < 768) ui.nav.classList.add('hidden');
        }

        async function runCode() {
            const code = ui.editor.value;
            const lesson = lessons[currentIndex];

            // UI Loading State
            ui.btnRun.innerHTML = '<i class="fa-solid fa-circle-notch fa-spin text-xs"></i> Procesando...';
            ui.btnRun.classList.add('opacity-75', 'cursor-not-allowed');
            ui.statusBadge.innerText = "RUNNING";
            ui.statusBadge.className = "px-2 py-0.5 rounded text-[10px] font-bold bg-blue-100 text-blue-600 uppercase animate-pulse";

            // Simular delay de red/proceso
            await new Promise(r => setTimeout(r, 600));

            const result = lesson.validate(code);

            // Mostrar resultado en consola
            const timestamp = new Date().toLocaleTimeString();
            
            if (result.success) {
                ui.console.innerHTML = `
                    <div class="mb-2 text-slate-500 border-b border-slate-800 pb-1">$ python3 main.py</div>
                    <div class="text-emerald-400 font-bold mb-1">${result.output}</div>
                    <div class="mt-2 text-xs text-slate-500">Process finished with exit code 0 (${timestamp})</div>
                    <div class="mt-2 pt-2 border-t border-slate-800 text-emerald-300"><i class="fa-solid fa-check-circle"></i> ${result.message}</div>
                `;
                ui.console.className = "bg-slate-900 rounded-lg p-4 font-mono text-sm min-h-[120px] max-h-[200px] overflow-y-auto custom-scrollbar text-slate-300 border border-emerald-500/50 shadow-lg shadow-emerald-500/10";
                
                // Update Button & Status
                ui.btnRun.innerHTML = '<i class="fa-solid fa-rotate-right text-xs"></i> Reintentar';
                ui.btnRun.className = "px-5 py-2 bg-slate-700 hover:bg-slate-600 text-slate-200 text-sm font-semibold rounded-lg transition-all flex items-center gap-2";
                
                ui.statusBadge.innerText = "SUCCESS";
                ui.statusBadge.className = "px-2 py-0.5 rounded text-[10px] font-bold bg-emerald-100 text-emerald-600 uppercase";

                // Show Next
                ui.btnNext.classList.remove('hidden');
                ui.btnNext.classList.add('flex');
                
                // Update Progress if completed
                const progress = Math.round(((currentIndex + 1) / lessons.length) * 100);
                ui.progressBar.style.width = `${progress}%`;
                ui.progressText.innerText = `${progress}%`;

            } else {
                ui.console.innerHTML = `
                    <div class="mb-2 text-slate-500 border-b border-slate-800 pb-1">$ python3 main.py</div>
                    <div class="text-red-400 font-bold mb-1">${result.output}</div>
                    <div class="mt-2 text-xs text-slate-500">Process finished with exit code 1 (${timestamp})</div>
                    <div class="mt-2 pt-2 border-t border-slate-800 text-red-300"><i class="fa-solid fa-circle-xmark"></i> ${result.message}</div>
                `;
                ui.console.className = "bg-slate-900 rounded-lg p-4 font-mono text-sm min-h-[120px] max-h-[200px] overflow-y-auto custom-scrollbar text-slate-300 border border-red-500/50 shadow-lg shadow-red-500/10";
                
                ui.btnRun.innerHTML = '<i class="fa-solid fa-play text-xs"></i> Ejecutar';
                ui.btnRun.classList.remove('opacity-75', 'cursor-not-allowed');
                
                ui.statusBadge.innerText = "ERROR";
                ui.statusBadge.className = "px-2 py-0.5 rounded text-[10px] font-bold bg-red-100 text-red-600 uppercase";
            }
        }

        // Listeners
        ui.btnRun.addEventListener('click', runCode);
        ui.btnNext.addEventListener('click', () => {
            if (currentIndex < lessons.length - 1) loadLesson(currentIndex + 1);
            else alert("隆Curso completado! ");
        });
        ui.menuBtn.addEventListener('click', () => ui.nav.classList.toggle('hidden'));

        // Tab support in Textarea
        ui.editor.addEventListener('keydown', function(e) {
            if (e.key == 'Tab') {
                e.preventDefault();
                var start = this.selectionStart;
                var end = this.selectionEnd;
                this.value = this.value.substring(0, start) + "    " + this.value.substring(end);
                this.selectionStart = this.selectionEnd = start + 4;
            }
        });

        // Init
        document.addEventListener('DOMContentLoaded', () => {
            loadLesson(0);
        });
    </script>
</body>
</html>
